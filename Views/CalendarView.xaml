<UserControl x:Class="DailyCheckInJournal.Views.CalendarView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:mc="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="700" d:DesignWidth="1000">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="View Previous Days" FontSize="24" FontWeight="Bold" Margin="0,0,0,20" Grid.Row="0"/>

        <!-- Calendar and Selected Day View -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="400"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Calendar -->
            <Border Grid.Column="0" BorderBrush="Gray" BorderThickness="1" Padding="10" Margin="0,0,20,0">
                <StackPanel>
                    <TextBlock Text="Select a date to view check-in details" 
                               FontSize="14" 
                               Margin="0,0,0,10"
                               TextWrapping="Wrap"/>
                    
                    <Calendar SelectedDate="{Binding SelectedDate}" 
                              DisplayDate="{Binding SelectedDate, TargetNullValue={x:Static sys:DateTime.Today}}"
                              Margin="0,0,0,10"/>

                    <Button Content="Refresh Calendar" 
                            Command="{Binding LoadCheckInsCommand}" 
                            HorizontalAlignment="Stretch"
                            Margin="0,10,0,0"/>
                </StackPanel>
            </Border>

            <!-- Selected Day Details -->
            <Border Grid.Column="1" BorderBrush="Gray" BorderThickness="1" Padding="15">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock FontSize="18" FontWeight="Bold" Margin="0,0,0,15">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="Check-In Details - {0:MMMM dd, yyyy}">
                                    <Binding Path="SelectedDate"/>
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>

                        <!-- No Check-In Message -->
                        <TextBlock Text="No check-in found for this date." 
                                   FontSize="14" 
                                   Foreground="Gray"
                                   Visibility="{Binding SelectedCheckIn, Converter={StaticResource NullToVisibilityConverter}}"
                                   Margin="0,20,0,0"/>

                        <!-- Check-In Details -->
                        <StackPanel Visibility="{Binding SelectedCheckIn, Converter={StaticResource NullToVisibilityConverter}}">
                            <!-- Morning Check-In Section -->
                            <GroupBox Header="Morning Check-In" Margin="0,0,0,15" 
                                      Visibility="{Binding SelectedCheckIn.Morning, Converter={StaticResource NullToVisibilityConverter}}">
                                <StackPanel Margin="10">
                                    <TextBlock Text="{Binding SelectedCheckIn.Morning.EnergyLevel, StringFormat='Energy Level: {0}/10'}" Margin="0,0,0,5"/>
                                    <TextBlock Text="{Binding SelectedCheckIn.Morning.MustDoToday, StringFormat='Must Do: {0}'}" Margin="0,0,0,5"/>
                                    <TextBlock Text="{Binding SelectedCheckIn.Morning.CapacityFeeling, StringFormat='Capacity Feeling: {0}/10'}" Margin="0,0,0,5"/>
                                    <TextBlock Text="{Binding SelectedCheckIn.Morning.CheckInTime, StringFormat='Checked in at: {0:g}'}" 
                                               FontStyle="Italic" 
                                               Foreground="Gray" 
                                               Margin="0,10,0,0"/>
                                </StackPanel>
                            </GroupBox>

                            <!-- Evening Check-In Section -->
                            <GroupBox Header="Evening Check-In" Margin="0,0,0,15"
                                      Visibility="{Binding SelectedCheckIn.Evening, Converter={StaticResource NullToVisibilityConverter}}">
                                <StackPanel Margin="10">
                                    <TextBlock Text="{Binding SelectedCheckIn.Evening.EnergyLevel, StringFormat='Energy Level: {0}/10'}" Margin="0,0,0,5"/>
                                    <TextBlock Text="{Binding SelectedCheckIn.Evening.MustDoCompleted, StringFormat='Must Do Completed: {0}'}" Margin="0,0,0,5"/>
                                    <TextBlock Text="{Binding SelectedCheckIn.Evening.Overcommitted, StringFormat='Overcommitted: {0}'}" Margin="0,0,0,5"/>
                                    <TextBlock Text="{Binding SelectedCheckIn.Evening.CheckInTime, StringFormat='Checked in at: {0:g}'}" 
                                               FontStyle="Italic" 
                                               Foreground="Gray" 
                                               Margin="0,10,0,0"/>
                                </StackPanel>
                            </GroupBox>

                            <TextBlock Text="Click 'View Full Details' to see all information for this day." 
                                       FontSize="12" 
                                       Foreground="Gray" 
                                       Margin="0,10,0,0"
                                       TextWrapping="Wrap"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- View Full Details Button -->
        <Button Content="View Full Details" 
                Command="{Binding ViewDayCommand}" 
                HorizontalAlignment="Center" 
                Padding="20,10" 
                FontSize="16" 
                Margin="0,20,0,0"
                Grid.Row="2"
                IsEnabled="{Binding SelectedDate, Converter={StaticResource NullToBoolConverter}}"/>
    </Grid>
</UserControl>

